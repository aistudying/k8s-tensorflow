[root@00-e0-81-ee-82-5b ~]# bash build_centos_gpu_drivers.sh 375.39 http://bootstrapper/static/CentOS7/gpu_drivers
+ DRIVER_VERSION=375.39
+ HTTP_GPU_DIR=http://bootstrapper/static/CentOS7/gpu_drivers
+ NVIDIA_RUN_NAME=NVIDIA-Linux-x86_64-375.39
+ NVIDIA_RUN_FILE=NVIDIA-Linux-x86_64-375.39.run
+ NVIDIA_DIR=/usr/local/nvidia
+ NVIDIA_BIN_DIR=/usr/local/nvidia/bin
+ NVIDIA_LIB_DIR=/usr/local/nvidia/lib64
+ LIBS_FILES=libraries-375.39.tar.bz2
+ TOOLS_FILES=tools-375.39.tar.bz2
+ TOOLS='nvidia-debugdump nvidia-cuda-mps-control nvidia-xconfig nvidia-modprobe nvidia-smi nvidia-cuda-mps-server nvidia-persistenced nvidia-settings'
+ disable_nouveau
+ cat
+ /sbin/modprobe -r nouveau
+ build_lib_and_ko
+ '[' '!' -f NVIDIA-Linux-x86_64-375.39.run ']'
+ chmod +x ./NVIDIA-Linux-x86_64-375.39.run
+ rm -rf NVIDIA-Linux-x86_64-375.39
+ ./NVIDIA-Linux-x86_64-375.39.run -x
Creating directory NVIDIA-Linux-x86_64-375.39
Verifying archive integrity... OK
Uncompressing NVIDIA Accelerated Graphics Driver for Linux-x86_64 375.39.........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
+ NVIDIA-Linux-x86_64-375.39/nvidia-installer -s

WARNING: nvidia-installer was forced to guess the X library path '/usr/lib64' and X module path '/usr/lib64/xorg/modules'; these paths were not queryable
         from the system.  If X fails to find the NVIDIA X driver module, please install the  utility and the X.Org SDK/development package
         for your distribution and reinstall the driver.


WARNING: Unable to determine the path to install the libglvnd EGL vendor library config files. Check that you have pkg-config and the libglvnd development
         libraries installed, or specify a path with --glvnd-egl-config-path.

++ basename -a NVIDIA-Linux-x86_64-375.39/libcuda.so.375.39 NVIDIA-Linux-x86_64-375.39/libEGL_nvidia.so.375.39 NVIDIA-Linux-x86_64-375.39/libEGL.so.1 NVIDIA-Linux-x86_64-375.39/libEGL.so.375.39 NVIDIA-Linux-x86_64-375.39/libGLdispatch.so.0 NVIDIA-Linux-x86_64-375.39/libGLESv1_CM_nvidia.so.375.39 NVIDIA-Linux-x86_64-375.39/libGLESv1_CM.so.1 NVIDIA-Linux-x86_64-375.39/libGLESv2_nvidia.so.375.39 NVIDIA-Linux-x86_64-375.39/libGLESv2.so.2 NVIDIA-Linux-x86_64-375.39/libGL.so.1.0.0 NVIDIA-Linux-x86_64-375.39/libGL.so.375.39 NVIDIA-Linux-x86_64-375.39/libGLX_nvidia.so.375.39 NVIDIA-Linux-x86_64-375.39/libGLX.so.0 NVIDIA-Linux-x86_64-375.39/libglx.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvcuvid.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-cfg.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-compiler.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-eglcore.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-egl-wayland.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-encode.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-fatbinaryloader.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-fbc.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-glcore.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-glsi.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-gtk2.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-gtk3.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-ifr.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-ml.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-opencl.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-ptxjitcompiler.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-tls.so.375.39 NVIDIA-Linux-x86_64-375.39/libnvidia-wfb.so.375.39 NVIDIA-Linux-x86_64-375.39/libOpenCL.so.1.0.0 NVIDIA-Linux-x86_64-375.39/libOpenGL.so.0 NVIDIA-Linux-x86_64-375.39/libvdpau_nvidia.so.375.39

+ tar -C NVIDIA-Linux-x86_64-375.39 -cvj libcuda.so.375.39 libEGL_nvidia.so.375.39 libEGL.so.1 libEGL.so.375.39 libGLdispatch.so.0 libGLESv1_CM_nvidia.so.375.39 libGLESv1_CM.so.1 libGLESv2_nvidia.so.375.39 libGLESv2.so.2 libGL.so.1.0.0 libGL.so.375.39 libGLX_nvidia.so.375.39 libGLX.so.0 libglx.so.375.39 libnvcuvid.so.375.39 libnvidia-cfg.so.375.39 libnvidia-compiler.so.375.39 libnvidia-eglcore.so.375.39 libnvidia-egl-wayland.so.375.39 libnvidia-encode.so.375.39 libnvidia-fatbinaryloader.so.375.39 libnvidia-fbc.so.375.39 libnvidia-glcore.so.375.39 libnvidia-glsi.so.375.39 libnvidia-gtk2.so.375.39 libnvidia-gtk3.so.375.39 libnvidia-ifr.so.375.39 libnvidia-ml.so.375.39 libnvidia-opencl.so.375.39 libnvidia-ptxjitcompiler.so.375.39 libnvidia-tls.so.375.39 libnvidia-wfb.so.375.39 libOpenCL.so.1.0.0 libOpenGL.so.0 libvdpau_nvidia.so.375.39
libcuda.so.375.39
libEGL_nvidia.so.375.39
libEGL.so.1
libEGL.so.375.39
libGLdispatch.so.0
libGLESv1_CM_nvidia.so.375.39
libGLESv1_CM.so.1
libGLESv2_nvidia.so.375.39
libGLESv2.so.2
libGL.so.1.0.0
libGL.so.375.39
libGLX_nvidia.so.375.39
libGLX.so.0
libglx.so.375.39
libnvcuvid.so.375.39
libnvidia-cfg.so.375.39
libnvidia-compiler.so.375.39
libnvidia-eglcore.so.375.39
libnvidia-egl-wayland.so.375.39
libnvidia-encode.so.375.39
libnvidia-fatbinaryloader.so.375.39
libnvidia-fbc.so.375.39
libnvidia-glcore.so.375.39
libnvidia-glsi.so.375.39
libnvidia-gtk2.so.375.39
libnvidia-gtk3.so.375.39
libnvidia-ifr.so.375.39
libnvidia-ml.so.375.39
libnvidia-opencl.so.375.39
libnvidia-ptxjitcompiler.so.375.39
libnvidia-tls.so.375.39
libnvidia-wfb.so.375.39
libOpenCL.so.1.0.0
libOpenGL.so.0
libvdpau_nvidia.so.375.39
+ tar -C NVIDIA-Linux-x86_64-375.39 -cvj nvidia-debugdump nvidia-cuda-mps-control nvidia-xconfig nvidia-modprobe nvidia-smi nvidia-cuda-mps-server nvidia-persistenced nvidia-settings
nvidia-debugdump
nvidia-cuda-mps-control
nvidia-xconfig
nvidia-modprobe
nvidia-smi
nvidia-cuda-mps-server
nvidia-persistenced
nvidia-settings
+ install_lib_and_ko
+ mkdir -p /usr/local/nvidia/bin
+ tar -xjf tools-375.39.tar.bz2 -C /usr/local/nvidia/bin
+ mkdir -p /usr/local/nvidia/lib64
+ tar -xjf libraries-375.39.tar.bz2 -C /usr/local/nvidia/lib64
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libcuda.so.375.39 /usr/local/nvidia/lib64/libcuda.so.1
+ ln -sf /usr/local/nvidia/lib64/libcuda.so.1 /usr/local/nvidia/lib64/libcuda.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libGLESv1_CM.so.375.39 /usr/local/nvidia/lib64/libGLESv1_CM.so.1
+ ln -sf /usr/local/nvidia/lib64/libGLESv1_CM.so.1 /usr/local/nvidia/lib64/libGLESv1_CM.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libGL.so.375.39 /usr/local/nvidia/lib64/libGL.so.1
+ ln -sf /usr/local/nvidia/lib64/libGL.so.1 /usr/local/nvidia/lib64/libGL.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libEGL.so.375.39 /usr/local/nvidia/lib64/libEGL.so.1
+ ln -sf /usr/local/nvidia/lib64/libEGL.so.1 /usr/local/nvidia/lib64/libEGL.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libnvidia-cfg.so.375.39 /usr/local/nvidia/lib64/libnvidia-cfg.so.1
+ ln -sf /usr/local/nvidia/lib64/libnvidia-cfg.so.1 /usr/local/nvidia/lib64/libnvidia-cfg.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libnvidia-encode.so.375.39 /usr/local/nvidia/lib64/libnvidia-encode.so.1
+ ln -sf /usr/local/nvidia/lib64/libnvidia-encode.so.1 /usr/local/nvidia/lib64/libnvidia-encode.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libnvidia-fbc.so.375.39 /usr/local/nvidia/lib64/libnvidia-fbc.so.1
+ ln -sf /usr/local/nvidia/lib64/libnvidia-fbc.so.1 /usr/local/nvidia/lib64/libnvidia-fbc.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libnvidia-ifr.so.375.39 /usr/local/nvidia/lib64/libnvidia-ifr.so.1
+ ln -sf /usr/local/nvidia/lib64/libnvidia-ifr.so.1 /usr/local/nvidia/lib64/libnvidia-ifr.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libnvidia-ml.so.375.39 /usr/local/nvidia/lib64/libnvidia-ml.so.1
+ ln -sf /usr/local/nvidia/lib64/libnvidia-ml.so.1 /usr/local/nvidia/lib64/libnvidia-ml.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libnvidia-opencl.so.375.39 /usr/local/nvidia/lib64/libnvidia-opencl.so.1
+ ln -sf /usr/local/nvidia/lib64/libnvidia-opencl.so.1 /usr/local/nvidia/lib64/libnvidia-opencl.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libnvcuvid.so.375.39 /usr/local/nvidia/lib64/libnvcuvid.so.1
+ ln -sf /usr/local/nvidia/lib64/libnvcuvid.so.1 /usr/local/nvidia/lib64/libnvcuvid.so
+ for LIBRARY_NAME in libcuda libGLESv1_CM libGL libEGL libnvidia-cfg libnvidia-encode libnvidia-fbc libnvidia-ifr libnvidia-ml libnvidia-opencl libnvcuvid libvdpau
+ ln -sf /usr/local/nvidia/lib64/libvdpau.so.375.39 /usr/local/nvidia/lib64/libvdpau.so.1
+ ln -sf /usr/local/nvidia/lib64/libvdpau.so.1 /usr/local/nvidia/lib64/libvdpau.so
+ ln -sf /usr/local/nvidia/lib64/libOpenCL.so.1.0.0 /usr/local/nvidia/lib64/libOpenCL.so.1
+ ln -sf /usr/local/nvidia/lib64/libOpenCL.so.1 /usr/local/nvidia/lib64/libOpenCL.so
+ ln -sf /usr/local/nvidia/lib64/libGLESv2.so.375.39 /usr/local/nvidia/lib64/libGLESv2.so.2
+ ln -sf /usr/local/nvidia/lib64/libGLESv2.so.2 /usr/local/nvidia/lib64/libGLESv2.so
+ ln -sf /usr/local/nvidia/lib64/libvdpau_nvidia.so.375.39 /usr/local/nvidia/lib64/libvdpau_nvidia.so
+ ln -sf /usr/local/nvidia/lib64/libvdpau_trace.so.375.39 /usr/local/nvidia/lib64/libvdpau_trace.so
+ wget -P /root http://bootstrapper/static/CentOS7/gpu_drivers/nvidia-gpu-mkdev.sh
--2017-06-02 11:19:02--  http://bootstrapper/static/CentOS7/gpu_drivers/nvidia-gpu-mkdev.sh
Resolving bootstrapper (bootstrapper)... 10.10.15.253
Connecting to bootstrapper (bootstrapper)|10.10.15.253|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 582 [text/plain]
Saving to: ‘/root/nvidia-gpu-mkdev.sh.6’

100%[=================================================================================================================>] 582         --.-K/s   in 0s      

2017-06-02 11:19:02 (59.3 MB/s) - ‘/root/nvidia-gpu-mkdev.sh.6’ saved [582/582]

+ /bin/bash /root/nvidia-gpu-mkdev.sh
+ /sbin/modprobe -r nouveau
+ /sbin/modprobe nvidia
++ lspci
++ grep -i NVIDIA
+ NVDEVS='04:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
05:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
08:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
09:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
85:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
86:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
89:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
8a:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)'
++ echo '04:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
05:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
08:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
09:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
85:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
86:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
89:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
8a:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)'
++ grep '3D controller'
++ wc -l
+ N3D=8
++ echo '04:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
05:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
08:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
09:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
85:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
86:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
89:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)
8a:00.0 3D controller: NVIDIA Corporation GK110GL [Tesla K20Xm] (rev a1)'
++ grep 'VGA compatible controller'
++ wc -l
+ NVGA=0
++ expr 8 + 0 - 1
+ N=7
++ seq 0 7
+ for i in ''
+ mknod -m 666 /dev/nvidia0 c 195 0
mknod: ‘/dev/nvidia0’: File exists
